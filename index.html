<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/3.0.0/aframe/build/aframe-ar-nft.js"></script>
    <script>
      AFRAME.registerComponent('shooter-game', {
        init: function () {
          this.setupCamera();
        },

        startGame: function () {
          this.boxInterval = setInterval(this.spawnBox.bind(this), 1000);
        },

        spawnBox: function () {
          const x = Math.random() * 10 - 5;
          const y = Math.random() * 5;
          const z = Math.random() * 10 - 15;
          const box = document.createElement('a-box');
          box.setAttribute('position', `${x} ${y} ${z}`);
          box.setAttribute('color', '#4CC3D9');
          this.el.sceneEl.appendChild(box);
        },

        setupCamera: function () {
          navigator.mediaDevices.getUserMedia({ video: true })
            .then((stream) => {
              const video = document.getElementById('video');
              video.srcObject = stream;
              video.play();
            })
            .catch((err) => console.error('カメラへのアクセスが拒否されました:', err));
        }
      });
    </script>
  </head>
  <body>
    <a-scene
      vr-mode-ui="enabled: false;"
      renderer="logarithmicDepthBuffer: true; precision: medium;"
      embedded
      arjs="trackingMethod: best; sourceType: webcam;debugUIEnabled: false;"
    >
      <!-- we use cors proxy to avoid cross-origin problems ATTENTION! you need to set up your server -->
      <a-marker preset="hiro">
        <a-box position="80 80 0" scale="70 70 70" color="tomato" wireframe="true" animation="property: rotation; to: 0 360 0; loop: true; dur: 20000" ></a-box>
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>
  </body>
</html>